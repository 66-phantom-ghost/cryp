<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Crypto‑Gate</title>

<style>
:root{
  --bg:#000;
  --card:#0b0b0b;
  --red:#ff073a;
  --green:#00ff41;
  --text:#e5e7eb;
  --muted:#777;
}

*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:radial-gradient(circle at center,#200000,#000);
  font-family:system-ui,Segoe UI,Roboto,sans-serif;
  color:var(--text);
}

.card{
  width:100%;
  max-width:460px;
  background:var(--card);
  border-radius:18px;
  padding:28px;
  box-shadow:0 0 40px rgba(255,7,58,.35);
}

h1{
  margin:0 0 6px;
  text-align:center;
  color:var(--red);
  letter-spacing:1px;
}

p{
  text-align:center;
  margin:0 0 24px;
  font-size:.85rem;
  color:var(--muted);
}

label{
  font-size:.75rem;
  color:var(--muted);
}

input,textarea{
  width:100%;
  margin-top:6px;
  margin-bottom:16px;
  padding:14px;
  background:#050505;
  color:var(--text);
  border-radius:10px;
  border:1px solid #111;
  outline:none;
  font-size:.9rem;
}

textarea{min-height:90px;resize:vertical}

.actions{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}

button{
  padding:14px;
  border:none;
  border-radius:12px;
  font-weight:700;
  cursor:pointer;
  transition:.15s;
}

.encrypt{
  background:linear-gradient(135deg,var(--red),#b00024);
  color:#fff;
}

.decrypt{
  background:linear-gradient(135deg,var(--green),#00b933);
  color:#001a07;
}

button:hover{transform:translateY(-2px)}

.output{
  margin-top:20px;
  padding:14px;
  border-radius:10px;
  background:#050505;
  border:1px solid #111;
  font-family:monospace;
  font-size:.85rem;
  word-break:break-all;
}

.meta{
  margin-top:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:.75rem;
  color:var(--muted);
}

.small-btn{
  background:transparent;
  border:1px solid var(--green);
  color:var(--green);
  padding:6px 10px;
  border-radius:8px;
  font-size:.7rem;
}

.small-btn:hover{
  background:rgba(0,255,65,.1);
}
</style>
</head>

<body>
<div class="card">
  <h1>Crypto‑Gate</h1>
  <p>Private · Server‑only · Long‑term</p>

  <label>Passwort</label>
  <input id="pw" type="password" />

  <label>Text</label>
  <textarea id="txt"></textarea>

  <div class="actions">
    <button class="encrypt" onclick="run('encrypt')">Verschlüsseln</button>
    <button class="decrypt" onclick="run('decrypt')">Entschlüsseln</button>
  </div>

  <div class="output" id="out">Bereit.</div>

  <div class="meta">
    <span id="info"></span>
    <button class="small-btn" onclick="resetClients()">Reset</button>
  </div>
</div>

<script>
const API = "https://unwintry-strapping-winford.ngrok-free.dev";

async function run(mode){
  out.textContent = "Verarbeite…";
  info.textContent = "";

  try{
    const r = await fetch(`${API}/api/${mode}`,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({
        password: pw.value.trim(),
        data: txt.value.trim()
      })
    });

    const j = await r.json();

    if(!r.ok) throw new Error(j.error || r.status);

    out.textContent = j.result;
    info.textContent = "OK";
  }
  catch(e){
    out.textContent = "Fehler: " + e.message;
  }
}

async function resetClients(){
  try{
    await fetch(`${API}/internal/reset-badclients`,{method:"POST"});
    info.textContent = "Reset OK";
  }catch{
    info.textContent = "Reset fehlgeschlagen";
  }
}

const pw = document.getElementById("pw");
const txt = document.getElementById("txt");
const out = document.getElementById("out");
const info = document.getElementById("info");
</script>
</body>
</html>
